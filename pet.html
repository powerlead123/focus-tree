<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>记事宠物</title>
    <link rel="stylesheet" href="pet.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <button class="btn-back" onclick="showPortal()">← 返回</button>
            <h1>📝 记事宠物</h1>
        </header>

        <!-- 宠物展示区 -->
        <div class="pet-stage">
            <div class="pet-container" id="petContainer">
                <div class="pet-character" id="petCharacter">🥚</div>
                <div class="pet-effects" id="petEffects"></div>
                <div class="pet-speech-bubble" id="petSpeech"></div>
            </div>
            
            <div class="pet-name" id="petName">我的宠物蛋</div>
            <div class="pet-mood" id="petMood">😊 心情很好</div>
        </div>

        <!-- 成长预览 -->
        <div class="growth-preview">
            <div class="preview-title">🔮 成长预览</div>
            <div class="preview-stages" id="previewStages"></div>
        </div>

        <!-- 宠物信息卡 -->
        <div class="pet-info-card">
            <div class="info-row">
                <span class="info-label">📊 成长值</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <span class="progress-text" id="progressText">0/30</span>
                </div>
            </div>
            <div class="info-row">
                <span class="info-label">🔥 连续打卡</span>
                <span class="info-value" id="streakDays">0 天</span>
            </div>
            <div class="info-row">
                <span class="info-label">🎂 宠物年龄</span>
                <span class="info-value" id="petAge">0 天</span>
            </div>
            <div class="info-row">
                <span class="info-label">⭐ 当前等级</span>
                <span class="info-value" id="petLevel">Lv.1 蛋</span>
            </div>
        </div>

        <!-- 打卡按钮 -->
        <div class="action-section">
            <button class="btn-checkin" id="checkinBtn" onclick="dailyCheckin()">
                <span class="btn-icon">✅</span>
                <span class="btn-text">今日已写记事</span>
            </button>
            <button class="btn-skip" id="skipBtn" onclick="showSkipModal()">
                <span class="btn-icon">📝</span>
                <span class="btn-text">今日未写记事</span>
            </button>
            <p class="checkin-hint" id="checkinHint">完成今天的记事本，给宠物喂食吧！</p>
        </div>

        <!-- 喂养按钮（打卡后显示） -->
        <div class="feeding-section hidden" id="feedingSection">
            <p class="feeding-hint">太棒了！现在给宠物喂食吧！</p>
            <button class="btn-feed" id="feedBtn" onclick="feedPet()">
                <span class="feed-icon">🍎</span>
                <span class="feed-text">喂食</span>
            </button>
        </div>

        <!-- 连续打卡奖励提示 -->
        <div class="streak-rewards">
            <div class="rewards-title">🎁 连续打卡奖励</div>
            <div class="rewards-list">
                <div class="reward-item">
                    <span class="reward-days">连续3天</span>
                    <span class="reward-prize">+5金币 🪙</span>
                </div>
                <div class="reward-item">
                    <span class="reward-days">连续5天</span>
                    <span class="reward-prize">+10金币 🪙</span>
                </div>
                <div class="reward-item">
                    <span class="reward-days">连续7天</span>
                    <span class="reward-prize">+20金币 + 宠物发光 ✨</span>
                </div>
                <div class="reward-item">
                    <span class="reward-days">连续30天</span>
                    <span class="reward-prize">解锁新宠物 🎉</span>
                </div>
            </div>
        </div>

        <!-- 成长提示 -->
        <div class="growth-hint" id="growthHint">
            距离下一阶段还需：<span id="daysToNext">6</span> 天
        </div>

        <!-- 宠物军团预览 -->
        <div class="pet-army">
            <div class="army-title">🌟 宠物军团（未来可解锁）</div>
            <div class="army-grid">
                <div class="army-pet unlocked">
                    <div class="army-emoji">🐣</div>
                    <div class="army-name">小鸡</div>
                    <div class="army-status">当前</div>
                </div>
                <div class="army-pet locked">
                    <div class="army-emoji">🐼</div>
                    <div class="army-name">熊猫</div>
                    <div class="army-status">30天解锁</div>
                </div>
                <div class="army-pet locked">
                    <div class="army-emoji">🦄</div>
                    <div class="army-name">独角兽</div>
                    <div class="army-status">60天解锁</div>
                </div>
                <div class="army-pet locked">
                    <div class="army-emoji">🐉</div>
                    <div class="army-name">小龙</div>
                    <div class="army-status">90天解锁</div>
                </div>
            </div>
        </div>

        <!-- 宠物图鉴按钮 -->
        <button class="btn-album" onclick="showAlbum()">📖 成长图鉴</button>
        <button class="btn-album" onclick="showGrowthGuide()" style="margin-top: 10px;">🔮 成长指南</button>
        <button class="btn-album" onclick="showRanking()" style="margin-top: 10px;">📊 对手排行</button>
        <button class="btn-album" id="gameBtn" onclick="showMiniGame()" style="margin-top: 10px; display: none;">🎮 小游戏</button>
        <button class="btn-album" id="costumeBtn" onclick="showCostumeShop()" style="margin-top: 10px; display: none;">🎨 换装</button>
        <button class="btn-album" id="achievementBtn" onclick="showAchievements()" style="margin-top: 10px; display: none;">🏆 成就</button>
    </div>

    <!-- 打卡成功动画 -->
    <div class="checkin-animation hidden" id="checkinAnimation">
        <div class="food-item">🍎</div>
    </div>

    <!-- 进化动画 -->
    <div class="evolution-overlay hidden" id="evolutionOverlay">
        <div class="evolution-content">
            <div class="evolution-light"></div>
            <div class="evolution-pet" id="evolutionPet">🥚</div>
            <div class="evolution-text">恭喜！你的宠物进化了！</div>
        </div>
    </div>

    <!-- 未写记事弹窗 -->
    <div class="modal hidden" id="skipModal">
        <div class="modal-content">
            <h2>📝 今日未写记事</h2>
            <p class="modal-desc">柏皓，告诉我为什么今天没写记事吧~</p>
            
            <div class="skip-reasons">
                <label class="reason-option">
                    <input type="radio" name="skipReason" value="forgot">
                    <span>😅 忘记了</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="skipReason" value="busy">
                    <span>⏰ 太忙了</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="skipReason" value="tired">
                    <span>😴 太累了</span>
                </label>
                <label class="reason-option">
                    <input type="radio" name="skipReason" value="other">
                    <span>📌 其他原因</span>
                </label>
            </div>
            
            <div class="pet-response" id="petResponse"></div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="confirmSkip()">确定</button>
                <button class="btn btn-secondary" onclick="closeSkipModal()">取消</button>
            </div>
        </div>
    </div>

    <!-- 成长相册弹窗 -->
    <div class="modal hidden" id="albumModal">
        <div class="modal-content">
            <h2>📖 成长相册</h2>
            <div class="album-grid" id="albumGrid"></div>
            <button class="btn btn-secondary" onclick="closeAlbum()">关闭</button>
        </div>
    </div>

    <!-- 成长指南弹窗 -->
    <div class="modal hidden" id="guideModal">
        <div class="modal-content modal-large">
            <h2>🔮 成长指南 - 你的宠物未来会变成这样！</h2>
            <p class="guide-intro">坚持写记事，见证宠物的华丽蜕变！每个阶段都有特殊能力哦~</p>
            <div class="guide-stages" id="guideStages"></div>
            <button class="btn btn-secondary" onclick="closeGuide()">关闭</button>
        </div>
    </div>

    <!-- 排行榜弹窗 -->
    <div class="modal hidden" id="rankingModal">
        <div class="modal-content modal-large">
            <h2>📊 记事排行榜</h2>
            <p class="ranking-intro">目标：成为优秀的人！（100米）</p>
            
            <div class="ranking-track" id="rankingTrack">
                <!-- 赛道将在这里显示 -->
            </div>
            
            <div class="ranking-tips">
                <div class="tip-item">💡 每日记事：前进3米</div>
                <div class="tip-item">⭐ 获得星评：额外前进1米</div>
                <div class="tip-item">🔥 连续3天：额外奖励2米</div>
            </div>
            
            <button class="btn btn-secondary" onclick="closeRanking()">关闭</button>
        </div>
    </div>

    <!-- 打卡评价弹窗 -->
    <div class="modal hidden" id="starModal">
        <div class="modal-content">
            <h2>⭐ 今天的记事</h2>
            <p class="modal-desc">柏皓，今天的记事获得老师的⭐了吗？</p>
            
            <div class="star-buttons">
                <button class="btn-star yes" onclick="confirmCheckinWithStar(true)">
                    <span class="star-icon">⭐</span>
                    <span class="star-text">获得了⭐</span>
                    <span class="star-reward">前进4米</span>
                </button>
                <button class="btn-star no" onclick="confirmCheckinWithStar(false)">
                    <span class="star-icon">📝</span>
                    <span class="star-text">还没有⭐</span>
                    <span class="star-reward">前进3米</span>
                </button>
            </div>
            
            <button class="btn btn-secondary" onclick="closeStarModal()" style="margin-top: 15px;">取消</button>
        </div>
    </div>

    <!-- 小游戏弹窗 -->
    <div class="modal hidden" id="gameModal">
        <div class="modal-content game-modal-content">
            <!-- 开始界面 -->
            <div id="gameStartScreen">
                <h2>🎮 接食物游戏</h2>
                <div class="game-intro">
                    <p>🍎 普通食物 +1分</p>
                    <p>🍪 好吃食物 +2分（发金光）</p>
                    <p>🍰 超级美味 +3分（发红光）</p>
                    <p>💩 炸弹 -3分（小心！）</p>
                    <p>⏱️ 30秒内尽可能多得分</p>
                    <p>⌨️ 使用键盘 ← → 方向键移动</p>
                    <p>🖱️ 或点击下方按钮移动</p>
                </div>
                <button class="btn btn-primary" onclick="startGame()">开始游戏</button>
                <button class="btn btn-secondary" onclick="closeGame()">关闭</button>
            </div>
            
            <!-- 游戏界面 -->
            <div id="gamePlayScreen" class="hidden">
                <div class="game-header">
                    <div class="game-stat">得分: <span id="gameScore">0</span></div>
                    <div class="game-stat">时间: <span id="gameTime">30</span>秒</div>
                </div>
                <div class="game-area" id="gameArea">
                    <div class="game-pet" id="gamePet">🐥</div>
                </div>
                <div class="game-controls">
                    <button class="btn-control" onclick="movePetTo('left')">← 左移</button>
                    <button class="btn-control" onclick="movePetTo('right')">右移 →</button>
                </div>
            </div>
            
            <!-- 结束界面 -->
            <div id="gameOverScreen" class="hidden">
                <h2>🎉 游戏结束</h2>
                <div class="game-result">
                    <div class="final-score">得分: <span id="finalScore">0</span></div>
                    <div class="game-comment" id="gameComment"></div>
                    <div class="game-reward" id="gameReward"></div>
                </div>
                <button class="btn btn-primary" onclick="startGame()">再玩一次</button>
                <button class="btn btn-secondary" onclick="closeGame()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 换装商店弹窗 -->
    <div class="modal hidden" id="costumeModal">
        <div class="modal-content">
            <h2>🎨 宠物换装</h2>
            <div class="costume-preview">
                <div class="preview-pet" id="previewPet">🐤</div>
                <div class="current-costume-name" id="currentCostumeName">默认造型</div>
            </div>
            <div class="costume-grid" id="costumeGrid"></div>
            <button class="btn btn-secondary" onclick="closeCostumeShop()">关闭</button>
        </div>
    </div>

    <!-- 成就系统弹窗 -->
    <div class="modal hidden" id="achievementModal">
        <div class="modal-content">
            <h2>🏆 成就收集</h2>
            <div class="achievement-stats">
                <div class="stat-item">
                    <span class="stat-label">已解锁</span>
                    <span class="stat-value"><span id="unlockedCount">0</span>/<span id="totalCount">0</span></span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">完成度</span>
                    <span class="stat-value" id="achievementProgress">0%</span>
                </div>
            </div>
            <div class="achievement-list" id="achievementList"></div>
            <button class="btn btn-secondary" onclick="closeAchievements()">关闭</button>
        </div>
    </div>

    <!-- 时空隧道传送门 -->
    <div class="portal-overlay hidden" id="portalOverlay">
        <!-- 时空隧道漩涡 -->
        <div class="portal-vortex" id="portalVortex">
            <div class="vortex-ring vortex-ring-1"></div>
            <div class="vortex-ring vortex-ring-2"></div>
            <div class="vortex-ring vortex-ring-3"></div>
            <div class="vortex-ring vortex-ring-4"></div>
            <div class="vortex-ring vortex-ring-5"></div>
        </div>
        
        <!-- 大门（漩涡消失后出现） -->
        <div class="portal-door" id="portalDoor"></div>
        
        <!-- 导航菜单（显示在大门上） -->
        <div class="portal-menu hidden" id="portalMenu">
            <h2 class="portal-title">🌟 选择你的目的地</h2>
            <div class="portal-nav-grid">
                <button class="portal-nav-btn" onclick="navigateTo('home.html')">
                    <div class="nav-icon">🏠</div>
                    <div class="nav-label">首页</div>
                </button>
                <button class="portal-nav-btn" onclick="navigateTo('index.html')">
                    <div class="nav-icon">🧘</div>
                    <div class="nav-label">专注训练</div>
                </button>
                <button class="portal-nav-btn" onclick="navigateTo('race.html')">
                    <div class="nav-icon">🏎️</div>
                    <div class="nav-label">口算竞速</div>
                </button>
                <button class="portal-nav-btn" onclick="navigateTo('eyecare.html')">
                    <div class="nav-icon">👀</div>
                    <div class="nav-label">护眼训练</div>
                </button>
                <button class="portal-nav-btn" onclick="navigateTo('shop.html')">
                    <div class="nav-icon">🛒</div>
                    <div class="nav-label">背景商城</div>
                </button>
                <button class="portal-nav-btn" onclick="closePortal()">
                    <div class="nav-icon">❌</div>
                    <div class="nav-label">取消</div>
                </button>
            </div>
        </div>
    </div>

    <!-- 提示消息 -->
    <div class="toast hidden" id="toast"></div>

    <script src="common.js"></script>
    <script src="pet.js"></script>
</body>
</html>
